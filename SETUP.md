# TreeShop SaaS - Quick Setup Guide

## What's Been Configured

âœ… **Project Initialized**
- Astro with React 19 integration
- TypeScript strictest mode
- Git repository ready

âœ… **Dependencies Installed**
- Material-UI (MUI) with dark theme
- Convex for real-time backend
- WorkOS for multi-tenant auth
- Google Maps API integration
- PWA support with Vite PWA plugin
- All pricing formula utilities

âœ… **Folder Structure Created**
```
src/
â”œâ”€â”€ components/
â”‚   â”œâ”€â”€ AppShell/          â† Main layout with right drawer navigation
â”‚   â”œâ”€â”€ Map/               â† Google Maps dashboard (map-centric view)
â”‚   â”œâ”€â”€ Pricing/           â† Calculator placeholder
â”‚   â”œâ”€â”€ Projects/          â† (create as needed)
â”‚   â”œâ”€â”€ Customers/         â† (create as needed)
â”‚   â””â”€â”€ Settings/          â† (create as needed)
â”œâ”€â”€ lib/
â”‚   â”œâ”€â”€ pricing/formulas.ts â† Complete pricing engine
â”‚   â”œâ”€â”€ theme.ts           â† MUI dark theme
â”‚   â”œâ”€â”€ convex/            â† (for Convex utilities)
â”‚   â”œâ”€â”€ workos/            â† (for WorkOS integration)
â”‚   â””â”€â”€ utils/             â† (for helpers)
â””â”€â”€ types/index.ts         â† TypeScript definitions
```

âœ… **Core Components Built**
- `AppShell` - Responsive layout with mobile drawer
- `RightDrawerNavigation` - Full navigation menu
- `MapDashboard` - Google Maps with dark mode styling
- `PricingCalculator` - Tabbed interface ready for implementation

âœ… **Backend Schema Ready**
- Complete Convex schema with all entities
- Organizations (multi-tenant root)
- Users, Equipment, Employees, Loadouts
- Customers, Projects, Proposals, Quotes
- All relationships and indexes configured

âœ… **PWA Configured**
- Manifest with TreeShop branding
- Service worker with Workbox
- Offline caching strategies
- Convex API and Google Maps caching

## Next Steps

### 1. Set Up Convex (Required)

```bash
# Initialize Convex project
npx convex dev
```

This will:
- Prompt you to create/select a Convex project
- Generate `.env.local` with your Convex URL
- Push the schema to your backend
- Start the Convex dev server

### 2. Configure Environment Variables

Create `.env` file:

```bash
cp .env.example .env
```

Add your API keys:
```env
# Convex (auto-generated by npx convex dev)
PUBLIC_CONVEX_URL=https://your-deployment.convex.cloud

# WorkOS (get from https://dashboard.workos.com)
WORKOS_API_KEY=sk_test_...
WORKOS_CLIENT_ID=client_...
PUBLIC_WORKOS_REDIRECT_URI=http://localhost:4321/auth/callback

# Google Maps (get from https://console.cloud.google.com)
PUBLIC_GOOGLE_MAPS_API_KEY=AIza...

# App Config
PUBLIC_APP_URL=https://treeshop.app
```

### 3. Start Development

In **two separate terminals**:

**Terminal 1 - Convex backend:**
```bash
npx convex dev
```

**Terminal 2 - Astro dev server:**
```bash
npm run dev
```

Open http://localhost:4321 to see the app!

## What You'll See

- **Map-centric dashboard** with dark mode Google Maps
- **Right drawer navigation** (desktop) or hamburger menu (mobile)
- **TreeShop branding** with green primary color (#4CAF50)
- **Fully responsive** layout that works on mobile and desktop

## Building Features

### Adding a New Page

1. Create route: `src/pages/projects.astro`
2. Import components and layout
3. Update navigation in `RightDrawerNavigation.tsx`

### Using Pricing Formulas

```typescript
import {
  calculateEquipmentCost,
  calculateProjectPricing,
  calculateStumpScore,
} from '@/lib/pricing/formulas';

// Example: Calculate equipment cost
const equipmentCost = calculateEquipmentCost({
  purchasePrice: 325000,
  usefulLifeYears: 7,
  annualHours: 1500,
  // ... other inputs
});

// Example: Calculate stump score
const stumpScore = calculateStumpScore({
  diameterInches: 18,
  heightAboveGradeFeet: 1,
  grindDepthBelowGradeFeet: 1,
  isHardwood: true,
  hasLargeRootFlare: false,
  // ... other modifiers
});
```

### Querying Convex Data

Create a query file in `convex/`:

```typescript
// convex/equipment.ts
import { query } from "./_generated/server";

export const list = query({
  handler: async (ctx) => {
    return await ctx.db.query("equipment").collect();
  },
});
```

Use in React component:

```typescript
import { useQuery } from "convex/react";
import { api } from "../convex/_generated/api";

function EquipmentList() {
  const equipment = useQuery(api.equipment.list);
  // ... render equipment
}
```

## Tech Stack Reference

| Technology | Purpose | Docs |
|------------|---------|------|
| Astro | Static site framework | https://docs.astro.build |
| React 19 | UI components | https://react.dev |
| MUI | Component library | https://mui.com |
| Convex | Real-time backend | https://docs.convex.dev |
| WorkOS | Authentication | https://workos.com/docs |
| Google Maps | Map integration | https://developers.google.com/maps |
| Vite PWA | Progressive web app | https://vite-pwa-org.netlify.app |

## Troubleshooting

### Convex not connecting
- Make sure `npx convex dev` is running
- Check `.env.local` has `CONVEX_DEPLOYMENT` set
- Verify `PUBLIC_CONVEX_URL` in `.env`

### Map not loading
- Check `PUBLIC_GOOGLE_MAPS_API_KEY` is set
- Enable Maps JavaScript API in Google Cloud Console
- Check browser console for API errors

### Build errors
- Run `npm run astro check` to see TypeScript errors
- Ensure all imports use correct paths
- Check that all React components use `client:only="react"` directive

## Ready to Code!

The foundation is set. You can now:
1. Build out the pricing calculators (Forestry, Stump, Land Clearing)
2. Implement WorkOS authentication
3. Create CRUD interfaces for Equipment, Employees, Loadouts
4. Build the project pipeline (Lead â†’ Proposal â†’ Work Order â†’ Invoice)
5. Add map features (project pins, route planning, etc.)

All the pricing formulas, database schema, and UI components are ready to use. Just start building features! ðŸš€
